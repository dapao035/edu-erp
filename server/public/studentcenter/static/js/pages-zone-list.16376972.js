(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-zone-list"],{"729a":function(t,e,i){"use strict";var n=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("8981")),s={data:function(){return{pageData:{page:1,lastPage:1}}},onReachBottom:function(){this.handleReachBottom()},methods:{foo:function(){console.log("foo")},handleReachBottom:function(){this.pageData.lastPage!=this.pageData.page&&(this.pageData.lastPage>this.pageData.page?(this.pageData.page++,this.handleReq()):a.default.showError("没有更多数据"))}}};e.default=s},"81bb":function(t,e,i){"use strict";var n=i("dbce"),a=i("4ea4");i("99af"),i("e25e"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=a(i("b85c")),o=i("cbec"),c=n(i("8981")),u=n(i("0a50")),l=a(i("729a")),r={mixins:[l.default],components:{},data:function(){return{tabs:["班级发布","我的发布"],TabCur:0,list:[],taskList:[],clazzId:"",isMine:0,audioContext:null,showCommentModal:!1,commentContent:"",commentId:0,commentIndex:0}},onLoad:function(){this.handleReq()},onShow:function(){},methods:{textareaInput:function(t){this.commentContent=t.detail.value},handleReq:function(){var t=this;u.get("student/zoneList",{page:this.pageData.page,mine:this.isMine},(function(e){"success"==e.result?(t.list=t.list.concat(e.data.data),t.pageData.page=parseInt(e.data.current_page),t.pageData.lastPage=parseInt(e.data.last_page)):c.showError(e.msg)}))},handleReqTasks:function(){var t=this;u.get("student/taskList",{page:this.pageData.page},(function(e){"success"==e.result?(t.taskList=t.taskList.concat(e.data.data),t.pageData.page=parseInt(e.data.current_page),t.pageData.lastPage=parseInt(e.data.last_page)):c.showError(e.msg)}))},toFinish:function(t){uni.navigateTo({url:"/pages/zone/publish?id="+t,animationDuration:200})},handleLike:function(t,e){var i=this;u.get("student/zoneLike",{id:t},(function(t){c.showError(t.msg),i.list[e].likes_count=t.data.count}))},handleComment:function(t,e){this.commentContent="",this.commentIndex=e,this.showCommentModal=!0,this.commentId=t},handleDelComment:function(t,e){var i=this;u.post("student/zoneCommentDel",{id:t},(function(t){c.showError(t.msg),i.list[e].comments=t.data.list}))},publishComment:function(){var t=this;u.post("student/zoneComment",{id:this.commentId,content:this.commentContent},(function(e){c.showError(e.msg),t.list[t.commentIndex].comments=e.data.list,t.showCommentModal=!1}))},fixImgUrlFunc:function(t){return(0,o.fixImgUrl)(t)},playAudio:function(t){var e,i=t.playing,n=(0,s.default)(this.list);try{for(n.s();!(e=n.n()).done;){var a=e.value;2==a.type&&this.$set(a,"playing",!1)}}catch(o){n.e(o)}finally{n.f()}if(1==i)return this.$set(t,"playing",!1),void this.audioContext.stop();this.$set(t,"playing",!0),this.audioContext&&this.audioContext.stop(),this.audioContext=uni.createInnerAudioContext(),this.audioContext.src=t.attach,this.audioContext.autoplay=!0,this.audioContext.onPlay((function(){console.log("开始播放")})),this.audioContext.onError((function(t){console.log(t.errMsg),console.log(t.errCode)}))},previewImg:function(t,e){var i,n=[],a=(0,s.default)(t);try{for(a.s();!(i=a.n()).done;){var o=i.value;n.push(this.fixImgUrlFunc(o))}}catch(c){a.e(c)}finally{a.f()}uni.previewImage({urls:n,current:n[e],longPressActions:{itemList:["发送给朋友","保存图片","收藏"],success:function(t){console.log("选中了第"+(t.tapIndex+1)+"个按钮,第"+(t.index+1)+"张图片")},fail:function(t){console.log(t.errMsg)}}})},tabSelect:function(t){this.TabCur=t.currentTarget.dataset.id,this.list=[],this.pageData.page=1,0==this.TabCur&&(this.list=[],this.isMine=0,this.handleReq()),1==this.TabCur&&(this.list=[],this.isMine=1,this.handleReq()),2==this.TabCur&&(this.taskList=[],this.handleReqTasks())}}};e.default=r},a5ec:function(t,e,i){"use strict";var n;i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return n}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"content"},[i("v-uni-scroll-view",{staticClass:"bg-white nav",attrs:{"scroll-x":!0}},[i("v-uni-view",{staticClass:"flex text-center"},t._l(t.tabs,(function(e,n){return i("v-uni-view",{key:n,staticClass:"cu-item flex-sub",class:n==t.TabCur?"text-orange cur":"",attrs:{"data-id":n},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.tabSelect.apply(void 0,arguments)}}},[t._v(t._s(t.tabs[n]))])})),1)],1),t._l(t.list,(function(e,n){return 2!=t.TabCur?i("v-uni-view",{key:n,staticClass:"cu-card dynamic no-card margin-bottom-sm"},[i("v-uni-view",{staticClass:"cu-item shadow"},[i("v-uni-view",{staticClass:"cu-list menu-avatar"},[i("v-uni-view",{staticClass:"cu-item "},[i("v-uni-view",{staticClass:"cu-avatar round",style:{"background-image":"url("+e.student_avatar+")"}}),i("v-uni-view",{staticClass:"content flex-sub flex justify-between"},[i("v-uni-view",[t._v(t._s(e.student_name))]),i("v-uni-view",{staticClass:"text-gray text-xs "},[t._v(t._s(e.add_time))])],1)],1)],1),e.content?i("v-uni-view",{staticClass:"text-content padding-top-sm"},[t._v(t._s(e.content))]):t._e(),1!=e.type?i("v-uni-view",{staticClass:"grid flex-sub padding-lr col-3 grid-square"},[t._l(e.attach,(function(n,a){return 3==e.type?i("v-uni-view",{key:a,staticClass:"bg-img",style:{backgroundImage:"url("+t.fixImgUrlFunc(n)+")"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.previewImg(e.attach,a)}}}):t._e()})),2==e.type?i("v-uni-view",{staticClass:"bg-gray",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.playAudio(e)}}},[e.playing?i("v-uni-text",{staticClass:"cuIcon-stop margin-lr-xs"}):i("v-uni-text",{staticClass:"cuIcon-playfill margin-lr-xs"})],1):t._e()],2):t._e(),i("v-uni-view",{staticClass:"text-gray text-right padding-sm"},[i("v-uni-view",{staticClass:"inline-block",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.handleLike(e.id,n)}}},[i("v-uni-text",{staticClass:"cuIcon-appreciatefill margin-lr-xs"}),t._v(t._s(e.likes_count))],1),i("v-uni-view",{staticClass:"inline-block margin-left",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.handleComment(e.id,n)}}},[i("v-uni-text",{staticClass:"cuIcon-messagefill margin-lr-xs"}),t._v(t._s(e.comments.length))],1)],1),e.verify_content?i("v-uni-view",{staticClass:"cu-list menu-avatar comment solids-top"},[i("v-uni-view",{staticClass:"cu-item"},[i("v-uni-view",{staticClass:"cu-avatar round",style:{"background-image":"url("+t.fixImgUrlFunc(e.verifier_photo)+")"}}),i("v-uni-view",{staticClass:"content"},[i("v-uni-view",{staticClass:"text-grey flex justify-between "},[i("v-uni-view",{staticClass:"text-sm"},[t._v(t._s(e.verifier_name)+" 点评:")]),i("v-uni-view",{staticClass:"text-xs "},[t._v(t._s(e.add_time))])],1),i("v-uni-view",{staticClass:"radius margin-top-sm"},[i("v-uni-view",{staticClass:"flex"},[i("v-uni-view",{staticClass:"flex-sub"},[t._v(t._s(e.verify_content))]),i("v-uni-view",{staticClass:"margin-left text-lg text-orange"},[t._v(t._s(e.verify_score)+"分")])],1)],1)],1)],1)],1):t._e(),i("v-uni-view",{staticClass:"padding-lr padding-bottom-sm "},t._l(e.comments,(function(e,a){return i("v-uni-view",{key:a,staticClass:"bg-gray padding-xs radius margin-top-sm"},[i("v-uni-text",{staticClass:"text-sm"},[t._v(t._s(e.publisher?e.publisher.name:"评论人")+"："+t._s(e.content))]),1==e.is_my?i("v-uni-text",{staticClass:"text-sm margin-left text-blue",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.handleDelComment(e.id,n)}}},[t._v("删除")]):t._e()],1)})),1)],1),0==t.list.length?i("v-uni-view",{staticClass:"text-center padding text-gray"},[t._v("暂无记录")]):t._e()],1):t._e()})),2==t.TabCur?i("v-uni-view",{staticClass:"cu-list menu sm-border",staticStyle:{"padding-bottom":"200upx"}},[t._l(t.taskList,(function(e,n){return i("v-uni-view",{key:n,staticClass:"cu-item ",class:{arrow:0==e.is_finish}},[i("v-uni-view",{staticClass:"content padding-sm"},[i("v-uni-view",{staticClass:"text-black text-df"},[t._v(t._s(n+1)+"、"+t._s(e.content))])],1),i("v-uni-view",{staticClass:"action text-right"},[0==e.is_finish?i("v-uni-view",{staticClass:"text-orange",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toFinish(e.id)}}},[t._v("去完成")]):i("v-uni-view",{staticClass:"text-gray"},[t._v("已完成")])],1)],1)})),0==t.taskList.length?i("v-uni-view",{staticClass:"text-center padding text-gray"},[t._v("暂无记录")]):t._e()],2):t._e(),i("v-uni-view",{staticClass:"cu-modal",class:t.showCommentModal?"show":""},[i("v-uni-view",{staticClass:"cu-dialog"},[i("v-uni-view",{staticClass:"cu-bar bg-white justify-end"},[i("v-uni-view",{staticClass:"content"},[t._v("发布评论")]),i("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.showCommentModal=!1}}},[i("v-uni-text",{staticClass:"cuIcon-close text-red"})],1)],1),i("v-uni-view",{},[i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-textarea",{staticClass:"text-left",staticStyle:{height:"300upx"},attrs:{maxlength:"-1",value:t.commentContent,placeholder:"请输入评论..."},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.textareaInput.apply(void 0,arguments)}}})],1)],1),i("v-uni-view",{staticClass:"cu-bar bg-white justify-end"},[i("v-uni-view",{staticClass:"action"},[i("v-uni-button",{staticClass:"cu-btn line-green text-green",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.showCommentModal=!1}}},[t._v("取消")]),i("v-uni-button",{staticClass:"cu-btn bg-green margin-left",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.publishComment.apply(void 0,arguments)}}},[t._v("确定")])],1)],1)],1)],1)],2)},s=[]},b4b9:function(t,e,i){"use strict";i.r(e);var n=i("81bb"),a=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=a.a},cbec:function(t,e,i){"use strict";i("a15b"),i("d81d"),i("fb6a"),i("b680"),i("d3b7"),i("acd8"),i("e25e"),i("ac1f"),i("25f0"),i("5319"),i("841c"),i("1276");var n=i("868c");function a(t){if("number"!==typeof t||t<0)return t;var e=parseInt(t/3600);t%=3600;var i=parseInt(t/60);t%=60;var n=t;return[e,i,n].map((function(t){return t=t.toString(),t[1]?t:"0"+t})).join(":")}function s(t,e){return"string"===typeof t&&"string"===typeof e&&(t=parseFloat(t),e=parseFloat(e)),t=t.toFixed(2),e=e.toFixed(2),{longitude:t.toString().split("."),latitude:e.toString().split(".")}}var o={UNITS:{"年":315576e5,"月":26298e5,"天":864e5,"小时":36e5,"分钟":6e4,"秒":1e3},humanize:function(t){var e="";for(var i in this.UNITS)if(t>=this.UNITS[i]){e=Math.floor(t/this.UNITS[i])+i+"前";break}return e||"刚刚"},format:function(t){var e=this.parse(t),i=Date.now()-e.getTime();if(i<this.UNITS["天"])return this.humanize(i);var n=function(t){return t<10?"0"+t:t};return e.getFullYear()+"/"+n(e.getMonth()+1)+"/"+n(e.getDate())+"-"+n(e.getHours())+":"+n(e.getMinutes())},parse:function(t){var e=t.split(/[^0-9]/);return new Date(e[0],e[1]-1,e[2],e[3],e[4],e[5])}};function c(t){return t&&-1==t.search("http")?("/"==t.slice(0,1)&&(t=t.substr(1)),n.baseUrl+t.replace("\\","/")):t}t.exports={formatTime:a,formatLocation:s,dateUtils:o,fixImgUrl:c}},ce90:function(t,e,i){"use strict";i.r(e);var n=i("a5ec"),a=i("b4b9");for(var s in a)"default"!==s&&function(t){i.d(e,t,(function(){return a[t]}))}(s);var o,c=i("f0c5"),u=Object(c["a"])(a["default"],n["b"],n["c"],!1,null,"04fb968d",null,!1,n["a"],o);e["default"]=u.exports}}]);