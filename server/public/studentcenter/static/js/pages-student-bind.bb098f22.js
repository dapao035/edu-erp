(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-student-bind"],{"0754":function(e,t,a){"use strict";a.r(t);var i=a("2a8f"),n=a.n(i);for(var s in i)"default"!==s&&function(e){a.d(t,e,(function(){return i[e]}))}(s);t["default"]=n.a},"2a8f":function(e,t,a){"use strict";var i=a("dbce"),n=a("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=n(a("ade3")),d=i(a("8981")),c=i(a("0a50")),r=(i(a("d06b")),{data:function(){return{updating:!1,address:"",birthday:"",id_card:"",name:"",password:"",mobile:"",code:"",sendBtnDisabled:!1,sendSec:0,typeIndex:0,genderIndex:0,types:["学生","家长"],gender:["保密","男","女"],clazzList:[],clazzIndex:0,className:""}},computed:{startDate:function(){return this.getDate("start")},endDate:function(){return this.getDate("end")}},onLoad:function(e){this.updating=1==e.upd,this.fetchUserInfo(),this.loadClazz(),uni.setNavigationBarTitle({title:"个人信息"})},methods:{fetchUserInfo:function(){var e=this;c.get("student/studentinfo",{},(function(t){if("success"==t.result){if(t.data.id&&(e.name=t.data.name,e.id_card=t.data.id_card,e.mobile=t.data.mobile,e.address=t.data.address,e.genderIndex=t.data.gender+0,e.birthday=t.data.birthday,e.className=t.data.clazz_name,e.typeIndex=t.data.type-1,e.className))for(var a in e.clazzList)if(e.clazzList[a]==e.className){e.clazzIndex=a;break}}else d.modelShow("错误",t.msg)}))},loadClazz:function(){var e=this;c.get("student/clazzList",{},(function(t){if("success"==t.result){if(e.clazzList=t.data.clazz,e.className)for(var a in e.clazzList)if(console.log(e.clazzList[a],e.className),e.clazzList[a]==e.className){e.clazzIndex=a;break}e.types=t.data.role}else d.showError(t.msg)}))},pickerChange:function(e){this.typeIndex=e.detail.value},pickerChange2:function(e){this.genderIndex=e.detail.value},clazzChange:function(e){this.clazzIndex=e.detail.value},handleLogin:function(){var e;""!=this.mobile?""!=this.name?0!=this.updating||""!=this.password?c.post("student/bind",(e={mobile:this.mobile,name:this.name,id_card:this.id_card},(0,s.default)(e,"mobile",this.mobile),(0,s.default)(e,"address",this.address),(0,s.default)(e,"birthday",this.birthday),(0,s.default)(e,"clazz",this.clazzList[this.clazzIndex]),(0,s.default)(e,"password",this.password),(0,s.default)(e,"gender",this.genderIndex),(0,s.default)(e,"updating",this.updating?1:0),(0,s.default)(e,"type",this.typeIndex+1),e),(function(e){"success"==e.result?(d.showSuccess(e.msg),uni.navigateTo({url:"/pages/index/index",animationDuration:200})):d.modelShow("错误提示",e.msg)})):d.showError("请输入绑定密码"):d.showError("请输入学生姓名"):d.showError("请输入账号")},sendSms:function(){var e=this;if(0!=d.isPhoneNumber(this.mobile)){this.sendBtnDisabled=!0,this.sendSec=30;var t=setInterval((function(){0==e.sendSec?(e.sendBtnDisabled=!1,clearInterval(t)):(e.sendBtnDisabled=!0,e.sendSec--)}),1e3);this.handleSent()}else d.showError("无效手机号")},bindDateChange:function(e){this.date=e.target.value},handleSent:function(){var e=this;c.post("sendsmscode",{mob:this.mobile},(function(t){"success"==t.result?d.showSuccess(t.msg):(t.data>0&&(e.sendSec=t.data),d.showError(t.msg))}))},getDate:function(e){if("start"===e)return"1980-01-01";var t=new Date,a=t.getFullYear(),i=t.getMonth()+1,n=t.getDate();return a-=1,i=i>9?i:"0"+i,n=n>9?n:"0"+n,"".concat(a,"-12-31")}}});t.default=r},c7f3:function(e,t,a){"use strict";var i;a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"content"},[a("v-uni-view",[a("v-uni-view",{staticClass:"cu-form-group"},[a("v-uni-view",{staticClass:"title"},[e._v("学生姓名")]),a("v-uni-input",{attrs:{placeholder:"必填",name:"input",type:"text"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),a("v-uni-view",{staticClass:"cu-form-group"},[a("v-uni-view",{staticClass:"title"},[e._v("用户身份")]),a("v-uni-picker",{attrs:{value:e.typeIndex,range:e.types},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.pickerChange.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"picker"},[e._v(e._s(e.types[e.typeIndex]))])],1)],1),a("v-uni-view",{staticClass:"cu-form-group"},[a("v-uni-view",{staticClass:"title"},[e._v("选择班级")]),a("v-uni-picker",{attrs:{value:e.clazzIndex,range:e.clazzList},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.clazzChange.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"picker"},[e._v(e._s(e.clazzList[e.clazzIndex]))])],1)],1),0==e.updating?a("v-uni-view",{staticClass:"cu-form-group"},[a("v-uni-view",{staticClass:"title"},[e._v("班级密码")]),a("v-uni-input",{attrs:{placeholder:"请联系负责老师获取密码",name:"input",type:"text"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1):e._e(),a("v-uni-view",{staticClass:"cu-form-group"},[a("v-uni-view",{staticClass:"title"},[e._v("联系电话")]),a("v-uni-input",{attrs:{placeholder:"必填",name:"input",type:"text"},model:{value:e.mobile,callback:function(t){e.mobile=t},expression:"mobile"}})],1),1==e.updating?a("v-uni-view",[a("v-uni-view",{staticClass:"cu-form-group"},[a("v-uni-view",{staticClass:"title"},[e._v("出生年月")]),a("v-uni-input",{attrs:{placeholder:"选填 如:19990101",name:"input",type:"text"},model:{value:e.birthday,callback:function(t){e.birthday=t},expression:"birthday"}})],1),a("v-uni-view",{staticClass:"cu-form-group"},[a("v-uni-view",{staticClass:"title"},[e._v("联系地址")]),a("v-uni-input",{attrs:{placeholder:"选填",name:"input",type:"text"},model:{value:e.address,callback:function(t){e.address=t},expression:"address"}})],1),a("v-uni-view",{staticClass:"cu-form-group"},[a("v-uni-view",{staticClass:"title"},[e._v("身份证号")]),a("v-uni-input",{attrs:{placeholder:"选填",name:"input",type:"text"},model:{value:e.id_card,callback:function(t){e.id_card=t},expression:"id_card"}})],1),a("v-uni-view",{staticClass:"cu-form-group"},[a("v-uni-view",{staticClass:"title"},[e._v("性别")]),a("v-uni-picker",{attrs:{value:e.genderIndex,range:e.gender},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.pickerChange2.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"picker"},[e._v(e._s(e.gender[e.genderIndex]))])],1)],1)],1):e._e(),a("v-uni-view",{staticClass:"padding flex flex-direction",staticStyle:{width:"100%"}},[a("v-uni-button",{staticClass:"cu-btn bg-green margin-tb-sm lg shadow",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleLogin.apply(void 0,arguments)}}},[e._v(e._s(e.updating?"保存":"立即绑定"))])],1)],1)],1)},s=[]},cf9a:function(e,t,a){"use strict";a.r(t);var i=a("c7f3"),n=a("0754");for(var s in n)"default"!==s&&function(e){a.d(t,e,(function(){return n[e]}))}(s);var d,c=a("f0c5"),r=Object(c["a"])(n["default"],i["b"],i["c"],!1,null,"351e6796",null,!1,i["a"],d);t["default"]=r.exports}}]);