(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3cb718b3"],{bff8:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("cui-search",{attrs:{config:e.searchConfig},on:{handleRequest:e.handleRequest}}),n("cui-table",{ref:"tableBuilder",attrs:{config:e.tableConfig,selectedRows:e.selectedRows},on:{"update:selectedRows":function(t){e.selectedRows=t},"update:selected-rows":function(t){e.selectedRows=t}}}),n("CreateCourse",{ref:"editCourse",attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t},onSubmit:function(t){return e.$refs.tableBuilder.loadData()}}}),n("LinkCourse",{ref:"linkCourse",attrs:{courseId:e.editingId,visible:e.linkDialogVisible},on:{"update:visible":function(t){e.linkDialogVisible=t},onSubmit:function(t){return e.$refs.tableBuilder.loadData()}}})],1)},i=[],a=n("d282"),o=n("2934"),s=n("cabd"),u=n("cf45"),c={openCourse:function(e,t){Object(u["a"])(e,"请先选择课程")&&Object(o["b"])("确认启用课程?",s["h"],e,t)},closeCourse:function(e,t){Object(u["a"])(e,"请先选择课程")&&Object(o["b"])("确认禁用课程?",s["b"],e,t)}},l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("cui-dialog",{attrs:{title:e.formData.id?"修改课程":"添加课程",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t},submit:e.formSubmit}},[n("el-form",{ref:"formRef",attrs:{model:e.formData,rules:e.rules,"label-width":"120px",size:"mini"}},[n("el-form-item",{attrs:{label:"课程名称",prop:"name"}},[n("el-input",{model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),n("el-form-item",{attrs:{label:"选择科目",prop:"subjectId"}},[n("cui-select",{attrs:{code:"subject",value:e.formData.subjectId},on:{"update:value":function(t){return e.$set(e.formData,"subjectId",t)}}})],1),n("el-form-item",{attrs:{label:"出售单位",prop:"unitName"}},[n("el-radio-group",{model:{value:e.formData.unitName,callback:function(t){e.$set(e.formData,"unitName",t)},expression:"formData.unitName"}},[n("el-radio",{attrs:{label:"次"}},[e._v("次")]),n("el-radio",{attrs:{label:"期"}},[e._v("期")])],1)],1),"次"==e.formData.unitName?n("el-form-item",{attrs:{label:"单价",prop:"unitPrice"}},[n("el-input",{attrs:{type:"number"},scopedSlots:e._u([{key:"append",fn:function(){return[e._v("元")]},proxy:!0}],null,!1,2167684048),model:{value:e.formData.unitPrice,callback:function(t){e.$set(e.formData,"unitPrice",t)},expression:"formData.unitPrice"}})],1):e._e(),n("el-form-item",{attrs:{label:"总价",prop:"price"}},[n("el-input",{attrs:{type:"number"},scopedSlots:e._u([{key:"append",fn:function(){return[e._v("元")]},proxy:!0}]),model:{value:e.formData.price,callback:function(t){e.$set(e.formData,"price",t)},expression:"formData.price"}})],1),n("el-form-item",{attrs:{label:"课次数",prop:"lessonCount"}},[n("el-input",{attrs:{type:"number"},model:{value:e.formData.lessonCount,callback:function(t){e.$set(e.formData,"lessonCount",t)},expression:"formData.lessonCount"}})],1),n("el-form-item",{attrs:{label:"课堂类型",prop:"lessonType"}},[n("cui-radio-enum",{attrs:{code:"LessonTypeEnum",value:e.formData.lessonType},on:{"update:value":function(t){return e.$set(e.formData,"lessonType",t)}}})],1),n("el-form-item",{attrs:{label:"有效月数",prop:"expireMonths"}},[n("el-input",{attrs:{type:"number"},scopedSlots:e._u([{key:"append",fn:function(){return[e._v("个月")]},proxy:!0}]),model:{value:e.formData.expireMonths,callback:function(t){e.$set(e.formData,"expireMonths",t)},expression:"formData.expireMonths"}})],1),n("el-form-item",{attrs:{label:"提示信息",prop:"info"}},[n("el-input",{attrs:{type:"textarea"},model:{value:e.formData.info,callback:function(t){e.$set(e.formData,"info",t)},expression:"formData.info"}})],1)],1)],1)},m=[],p=n("1da1"),f=(n("b0c0"),n("96cf"),n("ed08")),d={name:"",subjectId:"",unitPrice:"",price:"",unitName:"期",lessonCount:"",lessonType:"大班课",expireMonths:12,info:""},b={name:"CreateCourse",props:{visible:{type:Boolean,required:!0}},data:function(){return{formData:d,rules:{name:[{required:!0,message:"请输入名称"}],subjectId:[{required:!0,message:"请选择科目"}],unitPrice:[{required:!0,message:"请输入单价"}],price:[{required:!0,message:"请输入总价"}],lessonCount:[{required:!0,message:"请输入计划排课数"}],lessonType:[{required:!0,message:"请输入课堂类型"}],unitName:[{required:!0,message:"请选择单位"}],expireMonths:[{required:!0,message:"请输入有效月数"}]}}},computed:{dialogVisible:{get:function(){return!!this.visible},set:function(e){this.$emit("update:visible",e)}}},created:function(){},methods:{formSubmit:function(){var e=Object(p["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$refs.formRef.validate();case 2:if(t=e.sent,!0!==t){e.next=8;break}return e.next=6,Object(s["i"])(this.formData);case 6:n=e.sent,Object(f["a"])(n)&&(this.$emit("update:visible",!1),this.$emit("onSubmit"),this.initData(),Object(u["e"])("提交成功","success"));case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),initData:function(){this.formData=Object.assign({},d)},loadData:function(e){this.formData={id:e.id,name:e.name,subjectId:e.subjectId,unitPrice:e.unitPrice,price:e.price,unitName:e.unitName,lessonCount:e.lessonCount,lessonType:e.lessonType,expireMonths:e.expireMonths,info:e.info}}}},h=b,g=n("2877"),w=Object(g["a"])(h,l,m,!1,null,null,null),v=w.exports,k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("cui-dialog",{attrs:{title:"关联课程",visible:e.dialogVisible,width:"800px",showSubmitBtn:!1},on:{"update:visible":function(t){e.dialogVisible=t},onclose:function(t){return e.$emit("onSubmit")}}},[n("div",{staticClass:"text-info margin-bottom"},[e._v("关联课程是指购买了被关联的课程的学员, 可以到加入到一个班里参与上课, 并按1:1消课.")]),n("cui-table",{ref:"tableBuilder",attrs:{config:e.tableConfig,selectedRows:e.selectedRows},on:{"update:selectedRows":function(t){e.selectedRows=t},"update:selected-rows":function(t){e.selectedRows=t}}}),n("cui-dialog-form",{ref:"cuiDialogForm",attrs:{title:"添加关联",formConfig:e.formConfig,visible:e.formVisible},on:{"update:visible":function(t){e.formVisible=t},onSubmit:e.onSubmit}})],1)},j=[],y=(n("ac1f"),n("1276"),{name:"CreateCourse",props:{courseId:{required:!0},visible:{type:Boolean,required:!0}},data:function(){var e=this;return{tableConfig:{url:a["a"].courseList,condition:{},selectable:!0,autoLoad:!1,fields:[{title:"课程名称",name:"name"},{title:"科目",name:"subjectName"},{title:"价格",name:"price"},{title:"单位",name:"unitName"},{title:"班型",name:"lessonType"}],actions:[{title:"移除",click:function(t){e.unlink(t.id)}}],topActions:[{title:"新增关联",icon:"el-icon-plus",type:"primary",click:function(){e.formVisible=!0,e.$refs.cuiDialogForm.onReset()}}]},selectedRows:[],formConfig:{fields:[{label:"选择课程",name:"linkedIds",type:"selectBox",code:"course"}],rules:{linkedIds:[{required:!0,message:"请选择课程"}]}},formVisible:!1}},computed:{dialogVisible:{get:function(){return!!this.visible},set:function(e){this.$emit("update:visible",e)}}},watch:{visible:function(e){var t=this;e&&(this.tableConfig.condition={linkId:this.courseId},this.$nextTick((function(){return t.$refs.tableBuilder.loadData()})))}},created:function(){},methods:{onSubmit:function(){var e=Object(p["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.linkedIds&&0!=t.linkedIds.split(",")){e.next=3;break}return Object(u["e"])("请选择课程","error"),e.abrupt("return");case 3:return e.next=5,Object(s["g"])(this.courseId,t.linkedIds);case 5:n=e.sent,Object(f["a"])(n)&&(this.$refs.cuiDialogForm.onReset(),this.$refs.tableBuilder.loadData(),Object(u["e"])("已添加","success"));case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),unlink:function(){var e=Object(p["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["k"])(this.courseId,t);case 2:n=e.sent,Object(f["a"])(n)&&(this.$refs.tableBuilder.loadData(),Object(u["e"])("已移除","success"));case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}}),R=y,D=Object(g["a"])(R,k,j,!1,null,null,null),x=D.exports,C={name:"StudentCourse",components:{CreateCourse:v,LinkCourse:x},props:{},data:function(){var e=this;return{tableConfig:{url:a["a"].courseList,selectable:!0,condition:{},fields:[{title:"课程",name:"name"},{title:"科目",name:"subjectName"},{title:"课次数",name:"lessonCount",width:50},{title:"单次价",name:"unitPrice",width:50},{title:"总价",name:"price",width:50},{title:"单位",name:"unitName",width:50},{title:"班型",name:"lessonType",width:50},{title:"关联数",name:"linkCount",width:50},{title:"状态",name:"state",width:50}],actionWidth:"130px",actions:[{title:"编辑",click:function(t){e.$refs.editCourse.loadData(t),e.dialogVisible=!0}},{title:"关联课程",click:function(t){e.editingId=t.id,e.$refs.editCourse.loadData(t),e.linkDialogVisible=!0}}],topActions:[{title:"新增",icon:"el-icon-plus",type:"primary",click:function(){e.$refs.editCourse.initData(),e.dialogVisible=!0}},{title:"删除",icon:"el-icon-delete",click:function(){Object(o["c"])(s["c"],e.selectedRows,(function(){return e.handleRequest()}))}},{title:"启用",icon:"el-icon-check",click:function(){c.openCourse(e.selectedRows,(function(){return e.handleRequest()}))}},{title:"禁用",icon:"el-icon-close",click:function(){c.closeCourse(e.selectedRows,(function(){return e.handleRequest()}))}}],rowClassName:function(e){var t=e.row;return"启用"!=t.state?"warning-row":""}},selectedRows:[],searchConfig:{fields:[{label:"课程名称",name:"name",type:"input"},{label:"科目",name:"subjectId",type:"select",code:"subject"},{label:"状态",name:"state",type:"enum",code:"SwitchEnum"}]},dialogVisible:!1,linkDialogVisible:!1,editingId:""}},methods:{handleRequest:function(e){e&&Object.assign(this.tableConfig.condition,e),this.$refs.tableBuilder.loadData()}}},O=C,$=Object(g["a"])(O,r,i,!1,null,null,null);t["default"]=$.exports},cabd:function(e,t,n){"use strict";n.d(t,"i",(function(){return a})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return m})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"h",(function(){return g})),n.d(t,"b",(function(){return v})),n.d(t,"g",(function(){return j})),n.d(t,"k",(function(){return R})),n.d(t,"j",(function(){return x}));var r=n("1da1"),i=(n("96cf"),n("b775"));function a(e){return o.apply(this,arguments)}function o(){return o=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/course/save",method:"post",data:t}));case 1:case"end":return e.stop()}}),e)}))),o.apply(this,arguments)}function s(e){return u.apply(this,arguments)}function u(){return u=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/course/info",method:"GET",params:{id:t}}));case 1:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}function c(e){return l.apply(this,arguments)}function l(){return l=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/studentCourse/editLessonCountRemaining",method:"get",params:t}));case 1:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return p=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/studentCourse/editLessonExpireDate",method:"get",params:t}));case 1:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function f(e){return d.apply(this,arguments)}function d(){return d=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/studentCourse/changePriority",method:"get",params:t}));case 1:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function b(e){return h.apply(this,arguments)}function h(){return h=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/course/delete",method:"post",data:t}));case 1:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function g(e){return w.apply(this,arguments)}function w(){return w=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/course/open",method:"post",data:t}));case 1:case"end":return e.stop()}}),e)}))),w.apply(this,arguments)}function v(e){return k.apply(this,arguments)}function k(){return k=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/course/close",method:"post",data:t}));case 1:case"end":return e.stop()}}),e)}))),k.apply(this,arguments)}function j(e,t){return y.apply(this,arguments)}function y(){return y=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/course/link",method:"get",params:{courseId:t,linkedIds:n}}));case 1:case"end":return e.stop()}}),e)}))),y.apply(this,arguments)}function R(e,t){return D.apply(this,arguments)}function D(){return D=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/course/unlink",method:"get",params:{courseId:t,linkedIds:n}}));case 1:case"end":return e.stop()}}),e)}))),D.apply(this,arguments)}function x(e){return C.apply(this,arguments)}function C(){return C=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/refund/save",method:"post",data:t}));case 1:case"end":return e.stop()}}),e)}))),C.apply(this,arguments)}}}]);