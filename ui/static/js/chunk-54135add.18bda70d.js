(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-54135add"],{"9850c":function(e,t,n){"use strict";var i=n("1da1"),r=(n("96cf"),n("cf45")),a=n("2934"),o=n("49e5"),c=n("ed08");t["a"]={changeLearning:function(e,t){Object(r["a"])(e,"请先选择学员")&&Object(a["b"])("确认变为在学学员?",o["j"],e,t)},changeIntention:function(e,t){Object(r["a"])(e,"请先选择学员")&&Object(a["b"])("确认变为意向学员?",o["i"],e,t)},changeGraduation:function(e,t){Object(r["a"])(e,"请先选择学员")&&Object(a["b"])("确认变为结业学员?",o["h"],e,t)},handleDelete:function(e,t){Object(r["a"])(e,"请先选择学员")&&Object(a["b"])("确认删除?",o["m"],e,t)},studentLeaveCancel:function(e,t){Object(r["a"])(e,"请先选择")&&Object(a["b"])("确认撤销请假?",o["x"],e,t)},payOverdue:function(e,t){Object(r["b"])("确认提交？",Object(i["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(o["r"])(e);case 2:i=n.sent,Object(c["a"])(i)&&t(i);case 4:case"end":return n.stop()}}),n)}))))},deleteStudentCourse:function(e,t){Object(r["a"])(e,"请先选择合约")&&Object(a["b"])("确认删除合约?",o["n"],e,t)}}},d36d:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("cui-search",{attrs:{config:e.searchConfig},on:{handleRequest:e.handleRequest}}),n("cui-table",{ref:"tableBuilder",attrs:{config:e.tableConfig,selectedRows:e.selectedRows},on:{"update:selectedRows":function(t){e.selectedRows=t},"update:selected-rows":function(t){e.selectedRows=t}}}),n("cui-dialog-form",{ref:"cuiDialogForm",attrs:{title:"在学学员",formConfig:e.formConfig,visible:e.formVisible},on:{"update:visible":function(t){e.formVisible=t},onSubmit:e.onSubmit}}),n("create-student-course",{attrs:{studentId:e.studentInfo.id,studentName:e.studentInfo.name,visible:e.creatContractVisible},on:{"update:visible":function(t){e.creatContractVisible=t},onSubmit:e.afterCreate}}),n("cui-excel",{attrs:{visible:e.excelVisible,templateUrl:"/common/student/export",importUrl:"/common/student/import",params:e.uploadParam},on:{"update:visible":function(t){e.excelVisible=t}}}),n("cui-dialog-form",{ref:"changeCounselor",attrs:{title:"设置顾问",formConfig:e.formConfig3,visible:e.formVisible3},on:{"update:visible":function(t){e.formVisible3=t},onSubmit:e.onSubmit3}})],1)},r=[],a=n("1da1"),o=n("ade3"),c=(n("96cf"),n("b0c0"),n("d282")),s=n("9850c"),u=(n("61f7"),n("49e5")),l=n("2eb3"),d=n("ed08"),f=n("f87d"),b=n("cf45"),m={name:"StudentLearning",components:{CreateStudentCourse:l["a"]},data:function(){var e=this,t=this.$createElement;return{courseRecord:[],tableConfig:{url:c["a"].studentList,selectable:!0,fields:[{title:"编号",name:"id",width:"80px"},{title:"学员姓名",width:"80px",content:function(n){return t("span",{class:"text-link",on:{click:function(){return e.$router.push("/student/profile?id="+n.id)}}},[n.name])}},{title:"家长姓名",name:"parentName",width:"70px"},{title:"亲属关系",name:"familyRel",width:"70px"},{title:"联系电话",name:"mobile",width:"90px"},{title:"顾问",name:"counselorName",width:"80px"},{title:"分校",name:"schoolName",width:"120px"},{title:"课次数",width:60,content:function(n){return t("el-popover",{attrs:Object(o["a"])({placement:"bottom",title:n.name+" 的课次余量",width:"360",trigger:"hover"},"placement","top"),on:{show:function(){return e.getStudentCourse(n.id)}}},[t("el-table",{attrs:{data:e.courseRecord[n.id]}},[t("el-table-column",{attrs:{width:"",property:"courseName",label:"课程名"}}),t("el-table-column",{attrs:{width:"60",property:"countLessonTotal",label:"总课次"}}),t("el-table-column",{attrs:{width:"80",property:"countLessonRemaining",label:"剩余课次"}})]),t("span",{class:"text-link",slot:"reference"},[n.countLessonRemaining," ",t("i",{class:"el-icon-more text-link"})])])}},{title:"性别",name:"gender",width:"50px"},{title:"年龄",name:"age",width:"50px"},{title:"备注",name:"remark"}],actions:[{title:"查看",click:function(t){e.$router.push("/student/profile?id="+t.id)}},{title:"报单",click:function(t){e.handleContrac(t.id,t.name)}}],topActions:[{title:"添加学员",type:"primary",icon:"el-icon-plus",click:function(){e.handleAdd()}},{title:"转为意向学员",icon:"el-icon-check",click:function(){s["a"].changeIntention(e.selectedRows,(function(){return e.handleRequest()}))}},{title:"结业",icon:"el-icon-check",click:function(){s["a"].changeGraduation(e.selectedRows,(function(){return e.handleRequest()}))}},{title:"导入在学学员",icon:"el-icon-upload2",click:function(t){e.uploadParam={stage:2},e.excelVisible=!0}},{title:"修改顾问",icon:"el-icon-user",click:function(){1==e.selectedRows.length?(e.studentInfo.id=e.selectedRows[0].id,e.formVisible3=!0):Object(b["e"])("请选择1位学员","error")}}],condition:{stage:2}},selectedRows:[],searchConfig:{fields:[{label:"学员姓名",name:"keyword",type:"input",placeholder:"姓名或电话"}]},formConfig:f["a"],formVisible:!1,studentInfo:{id:"",name:""},creatContractVisible:!1,excelVisible:!1,uploadParam:{},formConfig3:{fields:[{label:"选择顾问",name:"staffId",type:"selectBox",code:"staff",limit:1}],rules:{staffId:[{required:!0,message:"请选择顾问"}]}},formVisible3:!1}},created:function(){},methods:{getStudentCourse:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.courseRecord[t]){e.next=5;break}return e.next=3,Object(u["w"])({studentId:t});case 3:n=e.sent,this.$set(this.courseRecord,t,n);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleEdit:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.formVisible=!0,e.next=3,Object(u["p"])(t);case 3:n=e.sent,this.$refs.cuiDialogForm.initFormData(n);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleAdd:function(){this.formVisible=!0,this.$refs.cuiDialogForm.onReset()},handleContrac:function(e,t){this.studentInfo.id=e,this.studentInfo.name=t,this.creatContractVisible=!0},handleRequest:function(e){e&&Object.assign(this.tableConfig.condition,e),this.$refs.tableBuilder.loadData()},onSubmit:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.stage="在学学员",e.next=3,Object(u["u"])(t);case 3:n=e.sent,Object(d["a"])(n)&&(this.$refs.cuiDialogForm.onReset(),this.$refs.tableBuilder.loadData());case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),afterCreate:function(){this.$refs.tableBuilder.loadData()},onSubmit3:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!=this.selectedRows.length){e.next=3;break}return Object(b["e"])("未选择学员","error"),e.abrupt("return");case 3:if(t.staffId&&""!=t.staffId){e.next=6;break}return Object(b["e"])("未选择顾问","error"),e.abrupt("return");case 6:if(this.studentInfo.id){e.next=9;break}return Object(b["e"])("未选择学生","error"),e.abrupt("return");case 9:return e.next=11,Object(u["d"])({studentId:this.studentInfo.id,staffId:t.staffId});case 11:n=e.sent,Object(d["a"])(n)&&(Object(b["e"])("已提交"),this.$refs.changeCounselor.onReset(),this.handleRequest());case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},h=m,p=n("2877"),g=Object(p["a"])(h,i,r,!1,null,null,null);t["default"]=g.exports}}]);