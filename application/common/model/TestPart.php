<?phpnamespace app\common\model;class TestPart extends BaseModel{    protected $table = 'test_part';    function testQuestion()    {        return $this->hasMany(TestQuestion::class, 'part_id')->order('sort_num');    }    static function updateTestRel(int $test_id, array $part_contents, array $part_ids, array $score)    {        if(count($part_contents) != count($part_ids))            exception('考试部分的标题和ID不对应');        self::where(compact('test_id'))->where('id','not in', $part_ids)->delete();        $insert = [];        foreach ($part_ids as $k => $pid) {            $data = [                'test_id' => $test_id,                'content' => $part_contents[$k],                'score' => $score[$k],                'sort_num' => $k,            ];            if($pid) {                self::where('id', $pid)->update($data);            }            else                $insert[] = $data;        }        if(count($insert)>0) self::insertAll($insert);    }}