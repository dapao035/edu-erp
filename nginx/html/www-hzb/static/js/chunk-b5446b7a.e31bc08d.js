(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b5446b7a"],{"3d80":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("cui-dialog",{attrs:{title:e.formData.id?"修改课次":"添加课次",visible:e.dialogVisible,width:"700px"},on:{"update:visible":function(t){e.dialogVisible=t},submit:e.formSubmit}},[i("cui-form",{ref:"formRef",attrs:{config:e.formConfig},on:{update:e.formUpdate}})],1)},a=[],s=i("1da1"),o=(i("96cf"),i("ac1f"),i("1276"),i("cf45")),l=i("8897"),r=i("ed08"),c={id:"",title:"",classId:"",teacherIds:"",assistantIds:"",date:"",startTime:"",endTime:"",roomId:"",decCount:1,bookable:!1},u={name:"CreateLesson",components:{},props:{visible:{type:Boolean,required:!0}},data:function(){return{lessonSetting:[],formConfig:{fields:[{label:"本课主题",name:"title",type:"input"},{label:"选择班级",name:"classId",type:"selectBox",code:"class",limit:1,condition:{over:!0}},{label:"上课老师",name:"teacherIds",type:"selectBox",code:"teacher",info:"支持多个老师，第一位为主讲人"},{label:"助教老师",name:"assistantIds",type:"selectBox",code:"teacher"},{label:"上课日期",name:"date",type:"date"},{label:"开始时间",name:"startTime",type:"time"},{label:"结束时间",name:"endTime",type:"time",minTime:"startTime"},{label:"选择教室",name:"roomId",type:"selectBox",code:"classroom",limit:1},{label:"消课次数",name:"decCount",type:"number"},{label:"是否开放预约",name:"bookable",type:"switch"}],rules:{classId:[{required:!0,message:"请选择班级",trigger:"change"}],teacherIds:[{required:!0,message:"请选择上课老师",trigger:"change"}],date:[{required:!0,message:"请设置上课日期"}],startTime:[{required:!0,message:"请选择开始日期"}],endTime:[{required:!0,message:"请选择结束日期"}]},labelWidth:"120px"},formData:Object.assign({},c)}},computed:{dialogVisible:{get:function(){return!!this.visible},set:function(e){this.$emit("update:visible",e)}}},created:function(){},methods:{formUpdate:function(e){this.formData=e},formSubmit:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$refs.formRef.onValidate();case 2:if(t=e.sent,!0===t){e.next=5;break}return e.abrupt("return");case 5:return i=Object.assign({},this.formData),i.teacherIds=this.formData.teacherIds?this.formData.teacherIds.split(","):[],i.assistantIds=this.formData.assistantIds?this.formData.assistantIds.split(","):[],e.next=10,Object(l["m"])(i);case 10:n=e.sent,Object(r["a"])(n)&&(this.$emit("update:visible",!1),this.$emit("onSubmit"),this.initData(),Object(o["e"])(n.msg,"success"));case 12:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),initData:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:"undefined"==typeof t&&(t=c),setTimeout((function(){i.$refs.formRef.setInitData(t)}),50);case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}},d=u,m=i("2877"),f=Object(m["a"])(d,n,a,!1,null,null,null);t["a"]=f.exports},b1a5:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("cui-search",{attrs:{config:e.searchConfig,showExport:!0},on:{handleRequest:e.handleRequest,handleExport:e.handleExport}}),i("cui-table",{ref:"tableBuilder",attrs:{config:e.tableConfig,selectedRows:e.selectedRows},on:{"update:selectedRows":function(t){e.selectedRows=t},"update:selected-rows":function(t){e.selectedRows=t}}}),i("CreateLesson",{ref:"createLesson",attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t},onSubmit:function(t){return e.$refs.tableBuilder.loadData()}}}),i("CreateLessonQuickly",{ref:"createLessonQuickly",attrs:{visible:e.dialogVisible1},on:{"update:visible":function(t){e.dialogVisible1=t},onSubmit:function(t){return e.$refs.tableBuilder.loadData()}}}),i("LessonInfo",{attrs:{visible:e.infoDialog,id:e.lessonId},on:{"update:visible":function(t){e.infoDialog=t}}}),i("RollCall",{attrs:{visible:e.rollcallDialog,id:e.lessonId},on:{"update:visible":function(t){e.rollcallDialog=t}}}),i("Evaluate",{attrs:{visible:e.evaluateDialog,id:e.lessonId},on:{"update:visible":function(t){e.evaluateDialog=t}}})],1)},a=[],s=i("d282"),o=i("a49b"),l=i("3d80"),r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("cui-dialog",{attrs:{title:"快速开课",visible:e.dialogVisible,width:"700px"},on:{"update:visible":function(t){e.dialogVisible=t},submit:e.formSubmit}},[i("el-alert",{staticStyle:{"margin-bottom":"10px"},attrs:{title:"快速开课允许在不创建班级的情况下添加课次，添加后会自动生成临时班级，若需要添加学生可到班级管理中添加",type:"info",closable:!1}}),i("cui-form",{ref:"formRef",attrs:{config:e.formConfig},on:{update:e.formUpdate}})],1)},c=[],u=i("1da1"),d=(i("96cf"),i("ac1f"),i("1276"),i("cf45")),m=i("8897"),f=i("ed08"),b={id:"",courseId:"",teacherIds:"",assistantIds:"",date:"",startTime:"",endTime:"",roomId:"",decCount:1,bookable:!1},h={name:"CreateLessonEasy",components:{},props:{visible:{type:Boolean,required:!0}},data:function(){return{lessonSetting:[],formConfig:{fields:[{label:"选择课程",name:"courseId",type:"selectBox",code:"course",limit:1},{label:"选择学生",name:"studentIds",type:"selectBox",code:"student"},{label:"上课老师",name:"teacherIds",type:"selectBox",code:"teacher",info:"支持多个老师，第一位为主讲人"},{label:"助教老师",name:"assistantIds",type:"selectBox",code:"teacher"},{label:"上课日期",name:"date",type:"date"},{label:"开始时间",name:"startTime",type:"time"},{label:"结束时间",name:"endTime",type:"time",minTime:"startTime"},{label:"选择教室",name:"roomId",type:"selectBox",code:"classroom",limit:1},{label:"消课次数",name:"decCount",type:"number"},{label:"是否开放预约",name:"bookable",type:"switch"}],rules:{courseId:[{required:!0,message:"请选择课程",trigger:"change"}],studentIds:[{required:!0,message:"请选择学生",trigger:"change"}],teacherIds:[{required:!0,message:"请选择上课老师",trigger:"change"}],date:[{required:!0,message:"请设置上课日期"}],startTime:[{required:!0,message:"请选择开始日期"}],endTime:[{required:!0,message:"请选择结束日期"}]},labelWidth:"120px"},formData:Object.assign({},b)}},computed:{dialogVisible:{get:function(){return!!this.visible},set:function(e){this.$emit("update:visible",e)}}},created:function(){},methods:{formUpdate:function(e){this.formData=e},formSubmit:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$refs.formRef.onValidate();case 2:if(t=e.sent,!0===t){e.next=5;break}return e.abrupt("return");case 5:return i=Object.assign({},this.formData),i.studentIds=this.formData.studentIds?this.formData.studentIds.split(","):[],i.teacherIds=this.formData.teacherIds?this.formData.teacherIds.split(","):[],i.assistantIds=this.formData.assistantIds?this.formData.assistantIds.split(","):[],e.next=11,Object(m["p"])(i);case 11:n=e.sent,Object(f["a"])(n)&&(this.$emit("update:visible",!1),this.$emit("onSubmit"),this.initData(),Object(d["e"])(n.msg,"success"));case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),initData:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:"undefined"==typeof t&&(t=b),setTimeout((function(){i.$refs.formRef.setInitData(t)}),50);case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}},p=h,g=i("2877"),I=Object(g["a"])(p,r,c,!1,null,null,null),w=I.exports,v=i("69d7"),y=i("2cdf"),D=i("8e64"),R={name:"LessonSchedule",components:{CreateLesson:l["a"],CreateLessonQuickly:w,LessonInfo:v["a"],RollCall:y["a"],Evaluate:D["a"]},props:{},data:function(){var e=this,t=this.$createElement;return{infoDialog:!1,lessonId:"",dialogVisible:!1,dialogVisible1:!1,rollcallDialog:!1,evaluateDialog:!1,tableConfig:{url:s["a"].lessonList,selectable:!0,condition:{dateRange:"本周"},fields:[{title:"上课时间",width:170,content:function(i){return t("span",{class:"text-link",on:{click:function(){return e.showInfo(i.id)}}},[i.date,"(",i.week,") ",i.startTime,"~",i.endTime])}},{title:"课程",name:"title"},{title:"班级名称",name:"className"},{title:"上课老师",name:"teacherNames"},{title:"类型",name:"lessonType",width:60},{title:"助教",name:"assistantNames",width:100},{title:"教室",name:"classroom",width:80},{title:"可预约",content:function(e){return t("span",[e.bookable?"开":"关"])},width:60},{title:"学生数",name:"studentNum",width:60},{title:"签到数",name:"studentSignNum",width:60},{title:"到课率",width:60,content:function(e){return t("span",[e.studentNum>0?parseInt(100*e.studentSignNum/e.studentNum):0,"%"])}},{title:"消课数",width:60,name:"decCount"},{title:"状态",width:60,name:"state"}],actionWidth:160,actions:[{title:"编辑",click:function(t){e.dialogVisible=!0,e.$refs.createLesson.initData(t)}},{title:"点名消课",click:function(t){e.lessonId=t.id,e.rollcallDialog=!0}},{title:"课后点评",visible:function(e){return"已结课"==e.state},click:function(t){e.lessonId=t.id,e.evaluateDialog=!0}}],topActions:[{title:"课表日历",icon:"el-icon-date",type:"primary",click:function(){e.$router.push("/course/calendar")}},{title:"按班级添加",icon:"el-icon-plus",click:function(){e.$refs.createLesson.initData(),e.dialogVisible=!0}},{title:"快速开课",icon:"el-icon-timer",click:function(){e.$refs.createLessonQuickly.initData(),e.dialogVisible1=!0}},{title:"删除课次",icon:"el-icon-delete",click:function(){o["a"].deleteLesson(e.selectedRows,(function(){return e.handleRequest()}))}},{title:"停课",icon:"el-icon-circle-close",click:function(){o["a"].stopLesson(e.selectedRows,(function(){return e.handleRequest()}))}},{title:"恢复上课",icon:"el-icon-refresh",click:function(){o["a"].reopenLesson(e.selectedRows,(function(){return e.handleRequest()}))}},{title:"开启预约",icon:"el-icon-check",click:function(){o["a"].handleOpenBooking(e.selectedRows,(function(){return e.handleRequest()}))}},{title:"关闭预约",icon:"el-icon-close",click:function(){o["a"].handleStopBooking(e.selectedRows,(function(){return e.handleRequest()}))}}],rowClassName:function(e){var t=e.row;return"已结课"==t.state?"success-row":"已停课"==t.state?"warning-row":""}},selectedRows:[],searchConfig:{fields:[{label:"周期",name:"dateRange",type:"enum",code:"DateRangeNameEnum",defaultValue:"本周"},{label:"班级",name:"classIds",type:"selectBox",code:"class"},{label:"课程",name:"courseIds",type:"selectBox",code:"course"},{label:"老师",name:"teacherIds",type:"selectBox",code:"teacher"},{label:"科目",name:"subjectId",type:"select",code:"subject",hidden:!0},{label:"开始日期",name:"startDate",type:"date",hidden:!0},{label:"结束日期",name:"endDate",type:"date",hidden:!0}]}}},methods:{showInfo:function(e){this.lessonId=e,this.infoDialog=!0},handleRequest:function(e){e&&Object.assign(this.tableConfig.condition,e),this.$refs.tableBuilder.loadData()},handleExport:function(e){Object(d["h"])(s["a"].lessonList,e)}}},k=R,x=Object(g["a"])(k,n,a,!1,null,null,null);t["default"]=x.exports}}]);